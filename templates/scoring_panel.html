{{/*
Copyright 2014 Team 254. All Rights Reserved.
Author: pat@patfairbank.com (Patrick Fairbank)

UI for entering realtime scores.
*/}}
{{define "title"}}Scoring Panel{{end}}
{{define "head"}}
<link href="/static/css/scoring_panel.css" rel="stylesheet">
{{end}}
{{define "body"}}
<div class="container" data-alliance="{{.Position.Alliance}}">
  <header id="banner">
    <div class="banner-title"></div>
    <div class="screen-title">
      {{.Position.Title}} - <span id="matchName">&nbsp;</span>
      <span id="matchState"></span>
      <span id="matchTime"></span>
    </div>
    <div class="banner-title"></div>
  </header>
  <main>
    <div class="d-flex flex-row flex-grow-1">
      <div id="tower-controls" class="p-3 flex-fill d-flex flex-column justify-content-center">
        <div id="tower-auto" class="mb-5">
          <h5 class="text-white mb-2">Auto Climb</h5>
          <div class="d-flex justify-content-evenly gap-3" style="height: 120px;">
            {{range $i, $v := seq 3}}
            {{template "teamButton" (dict "id" (printf "tower-auto-%d" $v) "index" $v "class" "team-button tower-auto-btn")}}
            {{end}}
          </div>
        </div>
        <div id="tower-teleop">
          <h5 class="text-white mb-2">Climb Level</h5>
          <div class="d-flex justify-content-evenly gap-3" style="height: 120px;">
            {{range $i, $v := seq 3}}
            {{template "teamButton" (dict "id" (printf "tower-teleop-%d" $v) "index" $v "class" "team-button tower-teleop-btn")}}
            {{end}}
          </div>
        </div>
      </div>

      <div id="fuel-controls" class="p-3 flex-fill d-flex flex-column justify-content-center">
        <div id="hub-active-indicator" class="mb-3 d-flex align-items-center justify-content-center gap-2">
          <div class="indicator-dot"></div>
          <span class="indicator-label text-white">HUB ACTIVE</span>
        </div>
        {{if not .PlcIsEnabled}}
        <div class="d-flex flex-column justify-content-center align-items-center gap-3">
          {{template "counter" (dict "id" "fuel-auto" "label" "Auto")}}
          {{template "counter" (dict "id" "fuel-teleop" "label" "Teleop")}}
        </div>
        {{else}}
        <div class="text-center p-5 text-white">
          <h4><i class="bi bi-cpu"></i> Fuel is being tracked automatically by PLC.</h4>
        </div>
        {{end}}
      </div>
    </div>

    <div id="bottom-controls" class="p-3 gap-3">
      <button id="commit" class="scoring-btn" ontouchstart disabled>Commit</button>
    </div>
  </main>
</div>
{{end}}

{{define "teamButton"}}
<button id="{{.id}}" class="{{.class}}" data-index="{{.index}}" ontouchstart>
  <div class="team-num">Team {{.index}}</div>
  <div class="team-text" id="{{.id}}-status">None</div>
</button>
{{end}}

{{define "counter"}}
<div class="counter" data-id="{{.id}}">
  <button class="minus" ontouchstart>-</button>
  <div class="counter-status">
    <div class="counter-label">{{.label}}</div>
    <div class="counter-main-value" id="value-{{.id}}">0</div>
  </div>
  <button class="plus" ontouchstart>+</button>
</div>
{{end}}

{{define "script"}}
<script src="/static/js/match_timing.js"></script>
<script src="/static/js/scoring_panel.js"></script>
{{end}}